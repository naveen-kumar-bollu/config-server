# Config Server Configuration
server:
  port: 8888

spring:
  application:
    name: config-server
  cloud:
    config:
      server:
        git:
          uri: ${GIT_URI:https://github.com/naveen-kumar-bollu/config-server-repo}
          default-label: ${GIT_DEFAULT_LABEL:main}
          clone-on-start: true
          timeout: 10
          username: ${GIT_USERNAME:}
          password: ${GIT_PASSWORD:}
          ignore-local-ssh-settings: true
          host-key-algorithm: ssh-rsa
          strict-host-key-checking: false

# Encryption Configuration (optional - only if keystore is provided)
encrypt:
  fail-on-error: false  # Don't fail if encryption is not available
  key-store:
    # On Render: docker-entrypoint.sh decodes KEYSTORE_BASE64 and exports KEYSTORE_LOCATION=file:/tmp/server.jks
    # Locally: set KEYSTORE_LOCATION=file:keystore/server.jks in your .env file
    location: ${KEYSTORE_LOCATION:}
    password: ${KEYSTORE_PASSWORD:}
    alias: ${KEYSTORE_ALIAS:config-server-key}
    secret: ${KEYSTORE_PASSWORD:}

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,encrypt,decrypt
  endpoint:
    health:
      show-details: when-authorized

# Logging
logging:
  level:
    '[org.springframework.cloud.config]': INFO
    '[org.springframework.security]': INFO
    '[com.configserver]': DEBUG

---
# Test Profile Configuration
spring:
  config:
    activate:
      on-profile: test
  cloud:
    config:
      server:
        git:
          uri: file:./config-repo
          clone-on-start: false
          ignore-local-ssh-settings: true

encrypt:
  key-store:
    location:
    password:
    alias:
    secret:
